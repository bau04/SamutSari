<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<title>SamutSari - Cart</title>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.0/css/all.min.css" rel="stylesheet">
	<link href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" rel="stylesheet">
	<link href="/css/style.css" rel="stylesheet">
	<style>
		/* minimal local tweaks so nav matches other pages */
		.bg-primary { background-color: #EE4D2D !important; }
		.text-primary { color: #EE4D2D !important; }
		.btn-primary { background-color: #EE4D2D !important; border-color: #EE4D2D !important; }
		.navbar { min-height: 70px !important; }
	</style>
</head>
<body>
	<!-- Topbar -->
	<div class="container-fluid">
		<div class="row bg-primary py-2 px-xl-5">
			<div class="col-lg-6 d-none d-lg-block">
				<div class="d-inline-flex align-items-center">
					<a class="text-light" href="">FAQs</a>
					<span class="text-light px-2">|</span>
					<a class="text-light" href="">Help</a>
					<span class="text-light px-2">|</span>
					<a class="text-light" href="">Support</a>
				</div>
			</div>
			<div class="col-lg-6 text-center text-lg-right">
				<div class="d-inline-flex align-items-center">
					<a class="text-light px-2" href="#"><i class="fab fa-facebook-f"></i></a>
					<a class="text-light px-2" href="#"><i class="fab fa-twitter"></i></a>
					<a class="text-light px-2" href="#"><i class="fab fa-instagram"></i></a>
					<a class="text-light px-2" href="#"><i class="fab fa-youtube"></i></a>
				</div>
			</div>
		</div>

		<div class="row align-items-center py-3 px-xl-5">
			<div class="col-lg-3 d-none d-lg-block">
				<a href="/" class="text-decoration-none">
					<h1 class="m-0 display-5 text-primary font-weight-semi-bold">
						<span class="text-primary font-weight-bold border px-3 mr-1">S</span>amutSari
					</h1>
				</a>
			</div>

			<div class="col-lg-6 col-6 text-left">
				<form action="/shop" method="GET">
					<div class="input-group">
						<input type="text" class="form-control" name="q" placeholder="Search for products">
						<div class="input-group-append">
							<button class="btn" type="submit"><span class="input-group-text bg-transparent text-primary"><i class="fa fa-search"></i></span></button>
						</div>
					</div>
				</form>
			</div>

			<!-- Right column intentionally left empty to remove heart/cart/save icons while preserving layout -->
			<div class="col-lg-3 col-6 text-right">
				<!-- icons removed for cart.ejs only -->
			</div>
		</div>
	</div>

	<!-- Main Navbar (no categories dropdown) -->
	<div class="container-fluid mb-5 position-relative">
		<div class="row border-top px-xl-5">
			<div class="col-lg-12">
				<nav class="navbar navbar-expand-lg bg-light navbar-light py-3 py-lg-0 px-0">
					<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarCollapseCart">
						<span class="navbar-toggler-icon"></span>
					</button>

					<div id="navbarCollapseCart" class="collapse navbar-collapse justify-content-between">
						<div class="navbar-nav mr-auto py-0">
							<a href="/" class="nav-item nav-link">Home</a>
							<a href="/loggedShop" class="nav-item nav-link">Shop</a>
							<a href="/loggedServices" class="nav-item nav-link">Services</a>
						</div>

						<div class="navbar-nav ml-auto py-0">
							<div class="nav-item dropdown">
								<a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">
									<i class="fas fa-user-circle text-primary" style="font-size: 24px;"></i>
								</a>
								<div class="dropdown-menu dropdown-menu-right">
									<a href="/profile" class="dropdown-item">Profile</a>
									<a href="/logout" class="dropdown-item">Logout</a>
								</div>
							</div>
						</div>
					</div>
				</nav>
			</div>
		</div>
	</div>

	<!-- Cart Content -->
	<div class="container py-5">
		<h2 class="mb-4">Shopping Cart</h2>
		<div class="row">
			<div class="col-lg-8">
				<div class="table-responsive mb-4">
					<table class="table table-borderless">
						<thead class="border-bottom">
							<tr>
								<th>Product</th>
								<th>Price</th>
								<th>Qty</th>
								<th>Subtotal</th>
								<th></th>
							</tr>
						</thead>
						<tbody>
							<% if (cartItems && cartItems.length > 0) { %>
								<% cartItems.forEach(function(item, idx) { %>
									<tr>
										<td class="align-middle">
											<div class="media">
												<img src="<%= item.image || '/images/sample-product.jpg' %>" alt="" style="width:80px; height:80px; object-fit:cover;" class="mr-3">
												<div class="media-body">
													<h6 class="mt-0"><%= item.name %></h6>
												</div>
											</div>
										</td>
										<td class="align-middle">₱<%= (Number(item.price) || 0).toLocaleString() %></td>
										<td class="align-middle"><%= item.quantity || 1 %></td>
										<td class="align-middle">₱<%= ((Number(item.price) || 0) * (Number(item.quantity) || 1)).toLocaleString() %></td>
										<td class="align-middle">
											<form action="/cart/remove" method="POST" style="display:inline;">
												<input type="hidden" name="productId" value="<%= item.productId || item._id %>">
												<button class="btn btn-sm btn-outline-danger">Remove</button>
											</form>
										</td>
									</tr>
								<% }) %>
							<% } else { %>
								<tr>
									<td colspan="5" class="text-center py-5">Your cart is empty. <a href="/loggedShop">Continue shopping</a></td>
								</tr>
							<% } %>
						</tbody>
					</table>
				</div>
			</div>

			<div class="col-lg-4">
				<div class="border p-4">
					<h5 class="mb-3">Order Summary</h5>
					<div class="d-flex justify-content-between mb-3">
						<h6 class="font-weight-medium">Subtotal</h6>
						<h6 class="font-weight-medium">₱<%= typeof totalPrice !== 'undefined' ? Number(totalPrice).toLocaleString() : 0 %></h6>
					</div>
					<div class="d-flex justify-content-between">
						<h6 class="font-weight-medium">Shipping</h6>
						<h6 class="font-weight-medium">₱0</h6>
					</div>
					<hr>
					<div class="d-flex justify-content-between mb-3 pt-1">
						<h5 class="font-weight-bold">Total</h5>
						<h5 class="font-weight-bold">₱<%= typeof totalPrice !== 'undefined' ? Number(totalPrice).toLocaleString() : 0 %></h5>
					</div>

					<!-- Checkout button always active now -->
					<a href="/checkout" class="btn btn-primary btn-block">Proceed to Checkout</a>
					<a href="/loggedShop" class="btn btn-secondary btn-block mt-2">Continue Shopping</a>
				</div>
			</div>
		</div>
	</div>

	<!-- JS -->
	<script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
	<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.bundle.min.js"></script>
</body>
</html>
